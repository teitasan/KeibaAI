
# モデル評価レポート

## 最終更新日時
2025-04-29 19:06:40

## 使用特徴量一覧

### 基本特徴量
- **オッズ関連**
  - `log_odds`: オッズの対数変換値
    - 変換方法: `np.log(data_df["オッズ"].values)`
    - 重要度: 1635

- **斤量関連**
  - `weight_scaled`: スケーリングされた斤量
    - 変換方法: `(data_df["斤量"].values - 48) * 2`
    - 重要度: 670

### レース間隔関連特徴量
- **interval_category**: レース間隔のカテゴリ分類
  - カテゴリ:
    1. `デビュー`: 初出走
    2. `連闘`: 0-8日
    3. `中1週`: 8-15日
    4. `中2-4週`: 15-35日
    5. `1-3ヶ月`: 35-91日
    6. `3-6ヶ月`: 91-182日
    7. `6ヶ月-1年`: 182-365日
    8. `1年以上`: 365日超
  - 重要度: 313

- **is_debut**: デビュー戦フラグ
  - 値: `0` または `1`
  - 計算方法: `last_race_date.isna().astype(int)`
  - 重要度: 52

### 時系列関連
- **days_since_last_race**: 前走からの経過日数
  - 計算方法: `(df["日付"] - df["last_race_date"]).dt.days`
  - 注意: デビュー戦の場合はNaN

### 目的変数
- **3着以内フラグ**
  - 計算方法: `(着順 <= 3).astype(int)`
  - 値: `0`（3着より下）または `1`（3着以内）

## 特徴量の重要度ランキング
- log(オッズ): 1635
- 斤量: 670
- interval_category: 313
- デビュー戦フラグ: 52

## モデル評価指標

### 全体評価指標
- accuracy: 0.747
- precision: 0.455
- recall: 0.716
- f1_score: 0.556
- best_threshold: 0.250

### レース単位評価指標
- Precision@3: 各レースで上位3頭予測に含まれた実際の3着以内馬の割合（平均）
  - 値: 0.531
- Recall@3: 各レースで実際の3着以内馬のうち、上位3頭予測に含まれた割合（平均）
  - 値: 0.531
- Hit Rate@3: 上位3頭予測に1頭でも3着以内馬が含まれていたレースの割合
  - 値: 0.937
- NDCG@3: 予測順位の質を評価する指標（1.0が最高値）
  - 値: 0.560
  - 説明: 上位3頭の予測順位が実際の3着以内馬の順位にどれだけ近いかを評価
  - 計算方法: DCG（予測順位の利得）をIDCG（理想的な順位の利得）で正規化

## 評価履歴
# モデル評価履歴

## 20250429_184831

### 評価指標
- accuracy: 0.747
- precision: 0.455
- recall: 0.716
- f1_score: 0.556
- best_threshold: 0.250

### 特徴量の重要度
- log(オッズ): 1635
- 斤量: 670
- interval_category: 313
- デビュー戦フラグ: 52

---

## 20250429_190040

### 評価指標
- accuracy: 0.747
- precision: 0.455
- recall: 0.716
- f1_score: 0.556
- best_threshold: 0.250
- precision_at_3: 0.531
- recall_at_3: 0.531
- hit_rate_at_3: 0.937

### 特徴量の重要度
- log(オッズ): 1635
- 斤量: 670
- interval_category: 313
- デビュー戦フラグ: 52

---

## 20250429_190640

### 評価指標
- accuracy: 0.747
- precision: 0.455
- recall: 0.716
- f1_score: 0.556
- best_threshold: 0.250
- precision_at_3: 0.531
- recall_at_3: 0.531
- hit_rate_at_3: 0.937
- ndcg_at_3: 0.560

### 特徴量の重要度
- log(オッズ): 1635
- 斤量: 670
- interval_category: 313
- デビュー戦フラグ: 52

---

